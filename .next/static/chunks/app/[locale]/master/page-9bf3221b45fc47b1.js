(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{9654:function(e,t,i){Promise.resolve().then(i.bind(i,342))},342:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});var n=i(7437),a=i(2265),r=i(8087),s=i(3907),o=i(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,o.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var c=i(7583),d=i(2022);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,o.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var m=i(495),p=i(7440),h=i(1513),f=i(4446);function x(){let e=(0,r.useTranslations)(),[t,i]=(0,a.useState)([]),[o,x]=(0,a.useState)(""),[y,g]=(0,a.useState)(!1),v=(0,a.useRef)(null),b=()=>{var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>{b()},[t]);let j=async()=>{if(!o.trim()||y)return;let e={id:Date.now().toString(),role:"user",content:o,timestamp:new Date};i(t=>[...t,e]),x(""),g(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:o,history:t.map(e=>({role:e.role,content:e.content}))})});if(!e.ok)throw Error("Failed to get response");let n=await e.json(),a={id:(Date.now()+1).toString(),role:"assistant",content:n.message,timestamp:new Date};i(e=>[...e,a])}catch(t){console.error("Error:",t);let e={id:(Date.now()+1).toString(),role:"assistant",content:"施主，贫僧正在闭关修炼，稍后为您解惑。",timestamp:new Date};i(t=>[...t,e])}finally{g(!1)}},w={id:"welcome",role:"assistant",content:"施主，贫僧在此恭候多时。\n\n天机阁汇聚五千年智慧，能为您推演命理、答疑解惑。\n\n有何困惑，尽管道来。",timestamp:new Date},N={hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:100,damping:20}}};return(0,n.jsxs)("div",{className:"flex h-[calc(100vh-4rem)] flex-col",children:[(0,n.jsx)(h.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"border-b border-mystic-500/20 bg-gradient-to-r from-card to-mystic-500/5 p-6",children:(0,n.jsxs)("div",{className:"container mx-auto flex items-center justify-between",children:[(0,n.jsxs)(h.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(h.E.div,{animate:{boxShadow:["0 0 20px rgba(139, 92, 246, 0.3)","0 0 40px rgba(139, 92, 246, 0.5)","0 0 20px rgba(139, 92, 246, 0.3)"]},transition:{duration:2,repeat:1/0},className:"flex h-14 w-14 items-center justify-center rounded-full bg-gradient-to-br from-mystic-500/20 to-gold-500/20",children:(0,n.jsx)(s.Z,{className:"h-7 w-7 text-mystic-400"})}),(0,n.jsx)(h.E.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"absolute -bottom-1 -right-1 h-5 w-5 rounded-full bg-green-500 ring-2 ring-background"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h.E.h1,{initial:{opacity:0},animate:{opacity:1},className:"text-xl font-semibold",children:"天机阁大师"}),(0,n.jsx)(h.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-xs text-muted-foreground",children:"AI智能 \xb7 随时在线 \xb7 精通易经"})]})]}),(0,n.jsx)(h.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,n.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>i([w]),className:"border-mystic-500/30",children:[(0,n.jsx)(l,{className:"mr-2 h-4 w-4"}),e("master.newChat")]})})]})}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,n.jsxs)("div",{className:"container mx-auto max-w-3xl space-y-6",children:[0===t.length&&(0,n.jsxs)(h.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,n.jsx)(h.E.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:3,repeat:1/0},className:"mx-auto mb-6 rounded-full bg-gradient-to-br from-mystic-500/20 to-gold-500/20 p-8",children:(0,n.jsx)(c.Z,{className:"h-16 w-16 text-mystic-400"})}),(0,n.jsx)(h.E.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-3 text-2xl font-bold gradient-text",children:e("master.title")}),(0,n.jsx)(h.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"max-w-md text-muted-foreground",children:e("master.subtitle")}),(0,n.jsx)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-8 flex flex-wrap justify-center gap-3",children:["我的财运如何？","今年运势怎么样？","适合做什么工作？","如何提升桃花运？"].map((e,t)=>(0,n.jsx)(h.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>x(e),className:"rounded-full border border-mystic-500/30 bg-mystic-500/10 px-4 py-2 text-sm text-mystic-400 transition-colors hover:bg-mystic-500/20",children:e},t))})]}),(0,n.jsx)(f.M,{children:t.map((e,t)=>(0,n.jsxs)(h.E.div,{variants:N,initial:"hidden",animate:"visible",exit:{opacity:0,y:-20},className:(0,p.cn)("flex space-x-4","user"===e.role&&"flex-row-reverse"),children:[(0,n.jsx)(h.E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.1},className:(0,p.cn)("flex h-12 w-12 shrink-0 items-center justify-center rounded-full","assistant"===e.role?"bg-gradient-to-br from-mystic-500/30 to-purple-600/30":"bg-gradient-to-br from-gray-500/30 to-gray-600/30"),children:"assistant"===e.role?(0,n.jsx)(s.Z,{className:"h-6 w-6 text-mystic-400"}):(0,n.jsx)(d.Z,{className:"h-6 w-6 text-gray-400"})}),(0,n.jsxs)(h.E.div,{initial:{opacity:0,x:"user"===e.role?20:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:(0,p.cn)("max-w-[80%] rounded-2xl px-6 py-4","assistant"===e.role?"rounded-tl-sm bg-gradient-to-br from-card to-mystic-500/5 border border-mystic-500/20":"rounded-tr-sm bg-gradient-to-br from-mystic-600 to-purple-600 text-white"),children:[(0,n.jsx)("div",{className:"whitespace-pre-wrap leading-relaxed",children:e.content.split("\n").map((e,t)=>(0,n.jsx)(h.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*t},children:e},t))}),(0,n.jsx)(h.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:(0,p.cn)("mt-3 text-xs","user"===e.role?"text-white/60":"text-muted-foreground"),children:e.timestamp.toLocaleTimeString()})]})]},e.id))}),y&&(0,n.jsxs)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex space-x-4",children:[(0,n.jsx)("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-mystic-500/30 to-purple-600/30",children:(0,n.jsx)(s.Z,{className:"h-6 w-6 text-mystic-400"})}),(0,n.jsx)("div",{className:"flex items-center space-x-2 rounded-xl border border-mystic-500/20 bg-card/50 px-6 py-4",children:[0,1,2].map(e=>(0,n.jsx)(h.E.div,{animate:{y:[0,-8,0],opacity:[.5,1,.5]},transition:{duration:.8,repeat:1/0,delay:.2*e},className:"h-3 w-3 rounded-full bg-mystic-400"},e))})]}),(0,n.jsx)("div",{ref:v})]})}),(0,n.jsx)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border-t border-mystic-500/20 bg-gradient-to-r from-card to-mystic-500/5 p-6",children:(0,n.jsxs)("div",{className:"container mx-auto max-w-3xl",children:[(0,n.jsxs)("div",{className:"relative flex items-end space-x-4",children:[(0,n.jsx)(h.E.div,{whileFocus:{scale:1.01},className:"flex-1",children:(0,n.jsx)("textarea",{value:o,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:e("master.placeholder"),rows:1,className:"w-full resize-none rounded-2xl border border-mystic-500/30 bg-background/80 px-6 py-4 pr-14 text-foreground placeholder:text-muted-foreground focus:border-mystic-500 focus:outline-none focus:ring-2 focus:ring-mystic-500/20 transition-all"})}),(0,n.jsx)(h.E.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,n.jsx)(m.z,{onClick:j,disabled:!o.trim()||y,variant:"mystic",size:"icon",className:"h-12 w-12 rounded-full",children:(0,n.jsx)(u,{className:"h-5 w-5"})})})]}),(0,n.jsx)(h.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mt-3 text-center text-xs text-muted-foreground",children:"基于 MiniMax AI 模型 \xb7 仅供娱乐参考"})]})})]})}},495:function(e,t,i){"use strict";i.d(t,{z:function(){return c}});var n=i(7437),a=i(2265),r=i(1538),s=i(3027),o=i(7440);let l=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",mystic:"bg-mystic-600 text-white hover:bg-mystic-700 glow"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:i,variant:a,size:s,asChild:c=!1,...d}=e,u=c?r.g7:"button";return(0,n.jsx)(u,{className:(0,o.cn)(l({variant:a,size:s,className:i})),ref:t,...d})});c.displayName="Button"},7440:function(e,t,i){"use strict";i.d(t,{cn:function(){return r}});var n=i(4839),a=i(6164);function r(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,a.m6)((0,n.W)(t))}},7583:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,i(1066).Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},2022:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,i(1066).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4446:function(e,t,i){"use strict";i.d(t,{M:function(){return y}});var n=i(7437),a=i(2265),r=i(5050),s=i(458),o=i(7797),l=i(9791);class c extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d(e){let{children:t,isPresent:i}=e,r=(0,a.useId)(),s=(0,a.useRef)(null),o=(0,a.useRef)({width:0,height:0,top:0,left:0}),{nonce:d}=(0,a.useContext)(l._);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:a}=o.current;if(i||!s.current||!e||!t)return;s.current.dataset.motionPopId=r;let l=document.createElement("style");return d&&(l.nonce=d),document.head.appendChild(l),l.sheet&&l.sheet.insertRule('\n          [data-motion-pop-id="'.concat(r,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(a,"px !important;\n          }\n        ")),()=>{document.head.removeChild(l)}},[i]),(0,n.jsx)(c,{isPresent:i,childRef:s,sizeRef:o,children:a.cloneElement(t,{ref:s})})}let u=e=>{let{children:t,initial:i,isPresent:r,onExitComplete:l,custom:c,presenceAffectsLayout:u,mode:p}=e,h=(0,s.h)(m),f=(0,a.useId)(),x=(0,a.useCallback)(e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;l&&l()},[h,l]),y=(0,a.useMemo)(()=>({id:f,initial:i,isPresent:r,custom:c,onExitComplete:x,register:e=>(h.set(e,!1),()=>h.delete(e))}),u?[Math.random(),x]:[r,x]);return(0,a.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[r]),a.useEffect(()=>{r||h.size||!l||l()},[r]),"popLayout"===p&&(t=(0,n.jsx)(d,{isPresent:r,children:t})),(0,n.jsx)(o.O.Provider,{value:y,children:t})};function m(){return new Map}var p=i(3241);let h=e=>e.key||"";function f(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}var x=i(9033);let y=e=>{let{children:t,custom:i,initial:o=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:d="sync",propagate:m=!1}=e,[y,g]=(0,p.oO)(m),v=(0,a.useMemo)(()=>f(t),[t]),b=m&&!y?[]:v.map(h),j=(0,a.useRef)(!0),w=(0,a.useRef)(v),N=(0,s.h)(()=>new Map),[E,k]=(0,a.useState)(v),[C,M]=(0,a.useState)(v);(0,x.L)(()=>{j.current=!1,w.current=v;for(let e=0;e<C.length;e++){let t=h(C[e]);b.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[C,b.length,b.join("-")]);let S=[];if(v!==E){let e=[...v];for(let t=0;t<C.length;t++){let i=C[t],n=h(i);b.includes(n)||(e.splice(t,0,i),S.push(i))}"wait"===d&&S.length&&(e=S),M(f(e)),k(v);return}let{forceRender:Z}=(0,a.useContext)(r.p);return(0,n.jsx)(n.Fragment,{children:C.map(e=>{let t=h(e),a=(!m||!!y)&&(v===C||b.includes(t));return(0,n.jsx)(u,{isPresent:a,initial:(!j.current||!!o)&&void 0,custom:a?void 0:i,presenceAffectsLayout:c,mode:d,onExitComplete:a?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==Z||Z(),M(w.current),m&&(null==g||g()),l&&l())},children:e},t)})})}}},function(e){e.O(0,[779,513,971,23,744],function(){return e(e.s=9654)}),_N_E=e.O()}]);